{% extends 'base.html' %}
{% load static %}

{% block content %}
<!-- Breadcrumb -->
<section class="bg-light py-3 mb-4">
  <div class="container">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb mb-0">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">Trang chủ</a></li>
        <li class="breadcrumb-item active" aria-current="page">
          {% if 'search' in request.path %}
            Kết quả tìm kiếm
          {% else %}
            Cửa hàng sách
          {% endif %}
        </li>
      </ol>
    </nav>
  </div>
</section>


<!-- Main Content -->
<!-- Main Content -->
<section class="section-content py-4">
  <div class="container">
    <div class="row">
      <!-- Sidebar -->
      <div class="col-lg-3 col-md-4">
        <div class="card mb-4 border-0 shadow-sm">
          <div class="card-header bg-white">
            <h5 class="mb-0">Danh mục</h5>
          </div>
          <div class="card-body">
            <div class="list-group list-group-flush">
              <a href="{% url 'store' %}" class="list-group-item list-group-item-action {% if not category %}active{% endif %}">
                Tất cả sản phẩm
              </a>
              {% for category in links %}
              <a href="{{ category.get_url }}" class="list-group-item list-group-item-action {% if category.slug == product_category.slug %}active{% endif %}">
                {{ category.category_name }}
              </a>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
      
      <!-- Product Listings -->
      <div class="col-lg-9 col-md-8">
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h4 class="mb-0">
            {% if category %}
              {{ category.category_name }}
            {% elif 'search' in request.path %}
              Kết quả tìm kiếm
            {% else %}
              Tất cả sản phẩm
            {% endif %}
          </h4>
          <span class="text-muted">Tìm thấy {{ product_count }} sản phẩm</span>
        </div>
        
        <div class="row">
          {% if products %}
            {% for product in products %}
            <div class="col-lg-3 col-md-4 col-6 mb-4">
              <div class="card card-product-grid-fahasa h-100">
                <a href="{{ product.get_url }}" class="img-wrap">
                  <img src="{{ product.images.url }}" class="product-image">
                </a>
                <figcaption class="info-wrap text-center p-3">
                  <a href="{{ product.get_url }}" class="title text-truncate mb-2 d-block">{{ product.product_name }}</a>
                  <div class="price-wrap">
                    {% if product.old_price %}
                    <del class="price-old d-block">{{ product.old_price }}đ</del>
                    {% endif %}
                    <span class="price-new-bold d-block">{{ product.price }}đ</span>
                  </div>
                  <a href="{{ product.get_url }}" class="btn btn-sm btn-primary mt-2">Xem chi tiết</a>
                </figcaption>
              </div>
            </div>
            {% endfor %}
          {% else %}
            <div class="col-12 text-center py-5">
              <h4 class="text-muted">Không tìm thấy sản phẩm phù hợp.</h4>
              <a href="{% url 'store' %}" class="btn btn-primary mt-3">Xem tất cả sản phẩm</a>
            </div>
          {% endif %}
        </div>

        <!-- Phần phân trang đã được loại bỏ -->
      </div>
    </div>
  </div>
</section>
{% endblock %}